<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multitasking Game</title>
    <script>
        // intro.htmlì„ ë¨¼ì € ë³´ì—¬ì£¼ê¸° ìœ„í•œ ì²´í¬
        if (!sessionStorage.getItem('introShown')) {
            window.location.href = 'intro.html';
        }
    </script>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://4pl67mv56j.execute-api.ap-northeast-2.amazonaws.com">
<link rel="stylesheet" href="https://4pl67mv56j.execute-api.ap-northeast-2.amazonaws.com/v1/api/css/drop_fontstream_css/?sid=gAAAAABpEtwWUmmMvQ93GGgVQi72HQ36TJMa9UETk_SqQIehtEZfz63ied3JUsZNRZKc_FflOdVbbbeRMTv7DPO4Kh4KFXxwdDyYlq4rxojd8vJIenL8HYjy52u6bL6a3kNDVqlRczbErQLyZmxmV3vFxO2PW5Ysb0p1tzGdvVBEyecC4h1RLmf4DwjASDMfotfjWZ90wEjXYBHFDLApPsHvfIOcblQhtEGLNjpLuF7JnYdrfOgus9a_USxRF5gaLJRTonv343Rh" charset="utf-8" referrerpolicy="origin"></link>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ë©”ì¸ í™”ë©´ -->
    <div class="main-screen" id="mainContainer">
        <div class="intro-text-container" id="introTextContainer" style="display: none;">
            <p class="intro-text" id="introText"></p>
            <button class="start-btn" id="startBtn" onclick="enterGames()">ì—…ë¬´ ì‹œì‘
            </button>
        </div>
    </div>

    <!-- ê²Œì„ë“¤ì´ ìŒ“ì—¬ìˆëŠ” ì˜ì—­ (ì²˜ìŒì—ëŠ” ìˆ¨ê¹€) -->
    <div class="games-wrapper" id="gamesWrapper" style="display: none;">
        <!-- ê²Œì„ 1 -->
        <div class="game-layer" id="game1">
            <div class="game-window" id="gameWindow1">
                <div class="window-header" id="windowHeader1">
                    <span class="window-title">TASK 1 ë©”ì¼ ë³´ë‚´ê¸°</span>
                    <span class="task-complete" id="taskComplete" style="display: none;">ì—…ë¬´ì™„ë£Œ</span>
                </div>
                <div class="window-content">
                    <div class="game-area" id="gameArea">
                        <div class="email-form">
                            <div class="email-header">
                                <div class="email-fields">
                                    <div class="email-field">
                                        <label>TO</label>
                                        <input type="text" id="emailTo" placeholder="">
                                    </div>
                                    <div class="email-field">
                                        <label>SUBJECT</label>
                                        <input type="text" id="emailSubject" placeholder="">
                                    </div>
                                </div>
                                <div class="email-options">
                                    <span class="cc-bcc">Cc Bcc</span>
                                </div>
                            </div>
                            <div class="email-body">
                                <textarea id="emailBody" placeholder=""></textarea>
                            </div>
                            <div class="email-footer">
                                <button class="send-btn" onclick="sendEmail()">Send</button>
                                <div class="email-actions">
                                    <button class="action-icon" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                                    <button class="action-icon" title="ë”ë³´ê¸°">â‹®</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ì•Œë¦¼ ì°½ (ê²Œì„ ì„¤ëª…) -->
        <div class="info-panel" id="infoPanel">
            <div class="info-header">
                <span class="info-title">NOTICE 1</span>
                <button class="minimize-btn" onclick="toggleInfoPanel()">_</button>
            </div>
            <div class="info-content" id="infoContent">
                <div class="notification-item">
                    <p class="notification-message">ì›ë¬¸ì„ ì°¸ê³ í•˜ì—¬ ë©”ì¼ì„ ì •í™•í•˜ê²Œ ì…ë ¥í•˜ê³  ë³´ë‚´ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>
                    <a href="#" class="view-original" onclick="openOriginalModal(event)">[ì›ë¬¸ë³´ê¸°]</a>
                </div>
            </div>
        </div>
        
        <!-- ì›ë¬¸ ëª¨ë‹¬ -->
        <div class="original-modal" id="originalModal" style="display: none;">
            <div class="original-modal-content" id="originalModalContent">
                <div class="original-modal-header" id="originalModalHeader">
                    <h3>[ì›ë¬¸]</h3>
                    <button class="original-modal-close" onclick="closeOriginalModal()">Ã—</button>
                </div>
                <div class="original-modal-body" id="originalModalBody">
                </div>
            </div>
        </div>
        
        <!-- ê²Œì„ 2ëŠ” task2.htmlì—ì„œ ë¡œë“œ -->
        <div id="task2Container"></div>
        
        <!-- ê²Œì„ 3ëŠ” task3.htmlì—ì„œ ë¡œë“œ -->
        <div id="task3Container"></div>
    </div>

    <script src="game1.js"></script>
    <script>
        function enterGames() {
            // ë©”ì¸ í™”ë©´ ìˆ¨ê¸°ê¸°
            document.getElementById('mainContainer').style.display = 'none';
            // ê²Œì„ ì˜ì—­ ë³´ì´ê¸°
            document.getElementById('gamesWrapper').style.display = 'block';
            
            // ì•Œë¦¼ ì°½ 1 ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
            initInfoPanelDrag('infoPanel', 'infoPanel');
            // ì•Œë¦¼ì°½ 1ì˜ ì´ˆê¸° right ê°’ ì €ì¥
            setTimeout(function() {
                const panel1 = document.getElementById('infoPanel');
                if (panel1) {
                    const computedStyle = window.getComputedStyle(panel1);
                    if (computedStyle.right !== 'auto') {
                        panel1.dataset.originalRight = computedStyle.right;
                    } else {
                        panel1.dataset.originalRight = '20px';
                    }
                    
                    // NOTICE 1 ìƒì„± ì‹œ ì‚¬ìš´ë“œ ì¬ìƒ
                    const audio = new Audio('note.mp3');
                    audio.volume = 0.15;
                    audio.play().catch(e => {
                        console.log('Audio play failed:', e);
                    });
                }
            }, 50);
            
            // 7ì´ˆ í›„ ê²Œì„ 2 ë¡œë“œ
            setTimeout(function() {
                loadTask2();
            }, 7000);
        }
        
        function initInfoPanelDrag(panelId, headerSelector) {
            const panel = document.getElementById(panelId);
            if (!panel) return;
            
            const header = panel.querySelector('.info-header');
            if (!header) return;
            
            let isDragging = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;

            // ì•Œë¦¼ ì°½ì˜ ì´ˆê¸° ìœ„ì¹˜ ì„¤ì •
            const rect = panel.getBoundingClientRect();
            const computedStyle = window.getComputedStyle(panel);
            
            // right ì†ì„±ì´ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ leftë¡œ ë³€í™˜
            if (computedStyle.right !== 'auto' && computedStyle.left === 'auto') {
                const rightValue = parseInt(computedStyle.right) || 20;
                xOffset = window.innerWidth - panel.offsetWidth - rightValue;
            } else {
                xOffset = rect.left;
            }
            yOffset = rect.top;
            
            // ì´ˆê¸° ìœ„ì¹˜ ì„¤ì •
            setTranslate(xOffset, yOffset, panel);

            header.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            header.addEventListener('touchstart', dragStartTouch);
            document.addEventListener('touchmove', dragTouch);
            document.addEventListener('touchend', dragEnd);

            function dragStart(e) {
                // minimize ë²„íŠ¼ í´ë¦­ ì‹œ ë“œë˜ê·¸ ë°©ì§€
                if (e.target.classList.contains('minimize-btn')) {
                    return;
                }
                
                if (e.type === "touchstart") {
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }
                isDragging = true;
                panel.classList.add('dragging');
            }

            function dragStartTouch(e) {
                if (e.target.classList.contains('minimize-btn')) {
                    return;
                }
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
                isDragging = true;
                panel.classList.add('dragging');
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    if (e.type === "touchmove") {
                        currentX = e.touches[0].clientX - initialX;
                        currentY = e.touches[0].clientY - initialY;
                    } else {
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                    }
                    xOffset = currentX;
                    yOffset = currentY;
                    const maxX = window.innerWidth - panel.offsetWidth;
                    const maxY = window.innerHeight - panel.offsetHeight;
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));
                    setTranslate(xOffset, yOffset, panel);
                }
            }

            function dragTouch(e) {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                    xOffset = currentX;
                    yOffset = currentY;
                    const maxX = window.innerWidth - panel.offsetWidth;
                    const maxY = window.innerHeight - panel.offsetHeight;
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));
                    setTranslate(xOffset, yOffset, panel);
                }
            }

            function dragEnd(e) {
                initialX = currentX;
                initialY = currentY;
                isDragging = false;
                panel.classList.remove('dragging');
            }

            function setTranslate(xPos, yPos, el) {
                el.style.left = xPos + 'px';
                el.style.top = yPos + 'px';
                el.style.transform = 'none';
                el.style.right = 'auto';
            }
        }
        
        function loadTask2() {
            // CSS ë¡œë“œ (ìºì‹œ ë°©ì§€)
            const existingLink = document.querySelector('link[href*="task2.css"]');
            if (existingLink) {
                existingLink.remove();
            }
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'task2.css?' + new Date().getTime();
            document.head.appendChild(link);
            
            fetch('task2.html?' + new Date().getTime(), { cache: 'no-store' })
                .then(response => response.text())
                .then(html => {
                    document.getElementById('task2Container').innerHTML = html;
                    // ê²Œì„ 2 ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
                    initGame2Drag();
                    // ìº˜ë¦°ë” ì´ˆê¸°í™”
                    setTimeout(function() {
                        initCalendar();
                    }, 200);
                    // ì•Œë¦¼ ì°½ 2 ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™” (DOMì´ ì™„ì „íˆ ë Œë”ë§ëœ í›„)
                    setTimeout(function() {
                        const panel2 = document.getElementById('infoPanel2');
                        if (panel2) {
                            initInfoPanelDrag('infoPanel2', 'infoPanel2');
                            // ì•Œë¦¼ì°½ 2ì˜ ì´ˆê¸° right ê°’ ì €ì¥
                            const computedStyle = window.getComputedStyle(panel2);
                            if (computedStyle.right !== 'auto') {
                                panel2.dataset.originalRight = computedStyle.right;
                            } else {
                                panel2.dataset.originalRight = '20px';
                            }
                            
                            // NOTICE 2 ìƒì„± ì‹œ ì‚¬ìš´ë“œ ì¬ìƒ
                            const audio = new Audio('note.mp3');
                            audio.volume = 0.15;
                            audio.play().catch(e => {
                                console.log('Audio play failed:', e);
                            });
                        }
                    }, 200);
                })
                .catch(error => {
                    console.error('ê²Œì„ 2 ë¡œë“œ ì‹¤íŒ¨:', error);
                    // fetch ì‹¤íŒ¨ ì‹œ ì§ì ‘ HTML ì‚½ì…
                    const fallbackHTML = `
                        <div class="game-layer" id="game2">
                            <div class="game-window" id="gameWindow2">
                                <div class="window-header" id="windowHeader2">
                                    <span class="window-title">TASK 2 íšŒì˜ ë‚ ì§œ ì„ íƒí•˜ê¸°</span>
                                    <span class="task-complete" id="taskComplete2" style="display: none;">ì—…ë¬´ì™„ë£Œ</span>
                                </div>
                                <div class="window-content">
                                    <div class="game-area" id="gameArea2">
                                        <div class="calendar-container">
                                            <div class="calendar-header">
                                                <button class="calendar-nav-btn" id="prevMonth">â€¹</button>
                                                <h3 class="calendar-title" id="calendarTitle">2025ë…„ 1ì›”</h3>
                                                <button class="calendar-nav-btn" id="nextMonth">â€º</button>
                                            </div>
                                            <div class="calendar-weekdays">
                                                <div class="weekday">ì¼</div>
                                                <div class="weekday">ì›”</div>
                                                <div class="weekday">í™”</div>
                                                <div class="weekday">ìˆ˜</div>
                                                <div class="weekday">ëª©</div>
                                                <div class="weekday">ê¸ˆ</div>
                                                <div class="weekday">í† </div>
                                            </div>
                                            <div class="calendar-days" id="calendarDays">
                                                <!-- ë‚ ì§œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="info-panel" id="infoPanel2">
                            <div class="info-header">
                                <span class="info-title">NOTICE 2</span>
                                <button class="minimize-btn" onclick="toggleInfoPanel2()">_</button>
                            </div>
                            <div class="info-content" id="infoContent2">
                                <div class="notification-item">
                                    <p class="notification-message">TASK 1 ë©”ì¼ì—ì„œì˜ íšŒì˜ ë‚ ì§œë¥¼ ìº˜ë¦°ë”ì—ì„œ í´ë¦­í•˜ì„¸ìš”.</p>
                                </div>
                            </div>
                        </div>
                    `;
                    document.getElementById('task2Container').innerHTML = fallbackHTML;
                    initGame2Drag();
                    // ìº˜ë¦°ë” ì´ˆê¸°í™”
                    setTimeout(function() {
                        initCalendar();
                    }, 200);
                    // ì•Œë¦¼ ì°½ 2 ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
                    setTimeout(function() {
                        const panel2 = document.getElementById('infoPanel2');
                        if (panel2) {
                            initInfoPanelDrag('infoPanel2', 'infoPanel2');
                            // ì•Œë¦¼ì°½ 2ì˜ ì´ˆê¸° right ê°’ ì €ì¥
                            const computedStyle = window.getComputedStyle(panel2);
                            if (computedStyle.right !== 'auto') {
                                panel2.dataset.originalRight = computedStyle.right;
                            } else {
                                panel2.dataset.originalRight = '20px';
                            }
                            
                            // NOTICE 2 ìƒì„± ì‹œ ì‚¬ìš´ë“œ ì¬ìƒ (fallback)
                            const audio = new Audio('note.mp3');
                            audio.volume = 0.15;
                            audio.play().catch(e => {
                                console.log('Audio play failed:', e);
                            });
                        }
                    }, 200);
                });
            
            // TASK 2 ë¡œë“œ í›„ 7ì´ˆ ë’¤ì— TASK 3 ë¡œë“œ
            setTimeout(function() {
                loadTask3();
            }, 7000);
        }
        
        function loadTask3() {
            // CSS ë¡œë“œ (ìºì‹œ ë°©ì§€)
            const existingLink = document.querySelector('link[href*="task3.css"]');
            if (existingLink) {
                existingLink.remove();
            }
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'task3.css?' + new Date().getTime();
            document.head.appendChild(link);
            
            fetch('task3.html?' + new Date().getTime(), { cache: 'no-store' })
                .then(response => response.text())
                .then(html => {
                    document.getElementById('task3Container').innerHTML = html;
                    // ê²Œì„ 3 ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
                    initGame3Drag();
                    // ì•Œë¦¼ ì°½ 3 ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™” (DOMì´ ì™„ì „íˆ ë Œë”ë§ëœ í›„)
                    setTimeout(function() {
                        const panel3 = document.getElementById('infoPanel3');
                        if (panel3) {
                            initInfoPanelDrag('infoPanel3', 'infoPanel3');
                            // ì•Œë¦¼ì°½ 3ì˜ ì´ˆê¸° right ê°’ ì €ì¥
                            const computedStyle = window.getComputedStyle(panel3);
                            if (computedStyle.right !== 'auto') {
                                panel3.dataset.originalRight = computedStyle.right;
                            } else {
                                panel3.dataset.originalRight = '20px';
                            }
                            
                            // NOTICE 3 ìƒì„± ì‹œ ì‚¬ìš´ë“œ ì¬ìƒ
                            const audio = new Audio('note.mp3');
                            audio.volume = 0.15;
                            audio.play().catch(e => {
                                console.log('Audio play failed:', e);
                            });
                        }
                    }, 200);
                    
                    // TASK 3 ì™„ë£Œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    setTimeout(function() {
                        const completeBtn = document.getElementById('completeTask3Btn');
                        if (completeBtn) {
                            completeBtn.addEventListener('click', completeTask3);
                        }
                    }, 200);
                })
                .catch(error => {
                    console.error('ê²Œì„ 3 ë¡œë“œ ì‹¤íŒ¨:', error);
                    // fetch ì‹¤íŒ¨ ì‹œ ì§ì ‘ HTML ì‚½ì…
                    const fallbackHTML = `
                        <div class="game-layer" id="game3">
                            <div class="game-window" id="gameWindow3">
                                <div class="window-header" id="windowHeader3">
                                    <span class="window-title">TASK 3 ì˜¤íƒˆì ìˆ˜ì •í•˜ê¸°</span>
                                    <span class="task-complete" id="taskComplete3" style="display: none;">ì—…ë¬´ì™„ë£Œ</span>
                                </div>
                                <div class="window-content">
                                    <div class="game-area" id="gameArea3">
                                        <div style="padding: 20px; font-family: 'Roboto', 'Apple SD Gothic Neo', 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif; font-size: 17px; line-height: 1.8; color: #333;">
                                            <div id="task3Text" contenteditable="true" style="margin-bottom: 30px; min-height: 150px; border: 1px solid #7d00ff; padding: 15px; background: white; white-space: pre-wrap;">ê¸ˆì£¼ ë§ˆì¼€íŒ… ë‚´ìš©ì„ ì •ë¦¬í•˜ì—¿ìŠµë‹ˆë‹¤.

ìƒˆë¡œìš´ ê³ ê° ì¸µ ë°˜ì‘ì´ ì˜ˆìŒë³´ë‹¤ ê¸ì •ì ì´ì—¿ìœ¼ë©°,

ì¶”ê°€ ë¶„ì„ ìë£ŒëŠ” ë‚´ì¼ ì¤‘ìœ¼ë¡œ ê³µìœ ë“œë¦¬ê°°ìŠµë‹ˆë‹¤.</div>
                                            <button id="completeTask3Btn" onclick="completeTask3()" class="send-btn">ìˆ˜ì • ì™„ë£Œ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="info-panel" id="infoPanel3">
                            <div class="info-header">
                                <span class="info-title">NOTICE 3</span>
                                <button class="minimize-btn" onclick="toggleInfoPanel3()">_</button>
                            </div>
                            <div class="info-content" id="infoContent3">
                                <div class="notification-item">
                                    <p class="notification-message">ë³´ê³ ì„œì—ì„œ ì˜ëª»ëœ ì² ìë¥¼ ëª¨ë‘ ìˆ˜ì •í•˜ì„¸ìš”. ìˆ˜ì •ì´ ì™„ë£Œë˜ë©´ ìˆ˜ì • ì™„ë£Œ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>
                                </div>
                            </div>
                        </div>
                    `;
                    document.getElementById('task3Container').innerHTML = fallbackHTML;
                    initGame3Drag();
                    // ì•Œë¦¼ ì°½ 3 ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
                    setTimeout(function() {
                        const panel3 = document.getElementById('infoPanel3');
                        if (panel3) {
                            initInfoPanelDrag('infoPanel3', 'infoPanel3');
                            // ì•Œë¦¼ì°½ 3ì˜ ì´ˆê¸° right ê°’ ì €ì¥
                            const computedStyle = window.getComputedStyle(panel3);
                            if (computedStyle.right !== 'auto') {
                                panel3.dataset.originalRight = computedStyle.right;
                            } else {
                                panel3.dataset.originalRight = '20px';
                            }
                            
                            // NOTICE 3 ìƒì„± ì‹œ ì‚¬ìš´ë“œ ì¬ìƒ
                            const audio = new Audio('note.mp3');
                            audio.volume = 0.15;
                            audio.play().catch(e => {
                                console.log('Audio play failed:', e);
                            });
                        }
                    }, 200);
                    
                    // TASK 3 ì™„ë£Œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    setTimeout(function() {
                        const completeBtn = document.getElementById('completeTask3Btn');
                        if (completeBtn) {
                            completeBtn.addEventListener('click', completeTask3);
                        }
                    }, 200);
                });
        }
        
        function initGame3Drag() {
            const gameWindow = document.getElementById('gameWindow3');
            const windowHeader = document.getElementById('windowHeader3');
            
            if (!gameWindow || !windowHeader) return;
            
            let isDragging = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;

            const rect = gameWindow.getBoundingClientRect();
            xOffset = rect.left;
            yOffset = rect.top;

            windowHeader.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            windowHeader.addEventListener('touchstart', dragStartTouch);
            document.addEventListener('touchmove', dragTouch);
            document.addEventListener('touchend', dragEnd);

            function dragStart(e) {
                if (e.type === "touchstart") {
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }
                isDragging = true;
                gameWindow.classList.add('dragging');
            }

            function dragStartTouch(e) {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
                isDragging = true;
                gameWindow.classList.add('dragging');
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    if (e.type === "touchmove") {
                        currentX = e.touches[0].clientX - initialX;
                        currentY = e.touches[0].clientY - initialY;
                    } else {
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                    }
                    xOffset = currentX;
                    yOffset = currentY;
                    const maxX = window.innerWidth - gameWindow.offsetWidth;
                    const maxY = window.innerHeight - gameWindow.offsetHeight;
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));
                    setTranslate(xOffset, yOffset, gameWindow);
                }
            }

            function dragTouch(e) {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                    xOffset = currentX;
                    yOffset = currentY;
                    const maxX = window.innerWidth - gameWindow.offsetWidth;
                    const maxY = window.innerHeight - gameWindow.offsetHeight;
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));
                    setTranslate(xOffset, yOffset, gameWindow);
                }
            }

            function dragEnd(e) {
                initialX = currentX;
                initialY = currentY;
                isDragging = false;
                gameWindow.classList.remove('dragging');
            }

            function setTranslate(xPos, yPos, el) {
                el.style.left = xPos + 'px';
                el.style.top = yPos + 'px';
                el.style.transform = 'none';
            }
        }
        
        function toggleInfoPanel3() {
            const panel = document.getElementById('infoPanel3');
            const content = document.getElementById('infoContent3');
            
            if (!panel) return;
            
            if (panel.classList.contains('minimized')) {
                panel.classList.remove('minimized');
                content.style.display = 'block';
                // right ì†ì„± ë³µì›
                if (panel.dataset.originalRight) {
                    panel.style.right = panel.dataset.originalRight;
                    panel.style.left = 'auto';
                } else {
                    // ì €ì¥ëœ ê°’ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
                    panel.style.right = '20px';
                    panel.style.left = 'auto';
                }
            } else {
                // ì¶•ì†Œ - ì˜¤ë¥¸ìª½ ìœ„ì¹˜ ìœ ì§€
                const computedStyle = window.getComputedStyle(panel);
                
                // originalRightê°€ ì—†ìœ¼ë©´ í˜„ì¬ ìƒíƒœì—ì„œ ì €ì¥
                if (!panel.dataset.originalRight) {
                    if (computedStyle.right !== 'auto') {
                        panel.dataset.originalRight = computedStyle.right;
                    } else if (computedStyle.left !== 'auto') {
                        // leftë¥¼ rightë¡œ ë³€í™˜
                        const leftValue = parseInt(computedStyle.left) || 0;
                        const rightValue = window.innerWidth - leftValue - panel.offsetWidth;
                        panel.dataset.originalRight = rightValue + 'px';
                    } else {
                        panel.dataset.originalRight = '20px';
                    }
                }
                
                // right ì†ì„± ì„¤ì •
                panel.style.right = panel.dataset.originalRight;
                panel.style.left = 'auto';
                panel.classList.add('minimized');
                content.style.display = 'none';
            }
        }
        
        function toggleWindowCollapse3() {
            const gameWindow = document.getElementById('gameWindow3');
            const windowContent = gameWindow.querySelector('.window-content');
            
            if (gameWindow.classList.contains('collapsed')) {
                // í¼ì¹˜ê¸°
                windowContent.style.display = 'flex';
                gameWindow.style.height = '400px';
                gameWindow.classList.remove('collapsed');
            } else {
                // ì ‘ê¸°
                windowContent.style.display = 'none';
                gameWindow.style.height = 'auto';
                gameWindow.classList.add('collapsed');
            }
        }
        
        function completeTask3() {
            const task3Text = document.getElementById('task3Text');
            if (!task3Text) return;
            
            // í…ìŠ¤íŠ¸ ë‚´ìš© ê°€ì ¸ì˜¤ê¸° (HTML íƒœê·¸ ì œê±°)
            const textContent = task3Text.innerText || task3Text.textContent;
            
            // ì •ë‹µ í…ìŠ¤íŠ¸ (ëª¨ë“  ì˜¤íƒˆì ìˆ˜ì •ëœ ë²„ì „)
            const correctText = `ê¸ˆì£¼ ë§ˆì¼€íŒ… ë‚´ìš©ì„ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

ìƒˆë¡œìš´ ê³ ê° ì¸µ ë°˜ì‘ì´ ì˜ˆìƒë³´ë‹¤ ê¸ì •ì ì´ì—ˆìœ¼ë©°,

ì¶”ê°€ ë¶„ì„ ìë£ŒëŠ” ë‚´ì¼ ì¤‘ìœ¼ë¡œ ê³µìœ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
            
            // í…ìŠ¤íŠ¸ ì •ê·œí™” (ì¤„ë°”ê¿ˆ, ê³µë°± ì •ê·œí™”)
            function normalizeText(text) {
                return text
                    .replace(/\r\n/g, '\n')
                    .replace(/\r/g, '\n')
                    .replace(/\n+/g, '\n')
                    .replace(/[ \t]+/g, ' ')
                    .trim();
            }
            
            const normalizedUserText = normalizeText(textContent);
            const normalizedCorrectText = normalizeText(correctText);
            
            // ì˜¤íƒˆì í™•ì¸
            const hasError1 = textContent.includes('ì •ë¦¬í•˜ì—¿ìŠµë‹ˆë‹¤');
            const hasError2 = textContent.includes('ì˜ˆìŒë³´ë‹¤');
            const hasError3 = textContent.includes('ê¸ì •ì ì´ì—¿ìœ¼ë©°');
            const hasError4 = textContent.includes('ê³µìœ ë“œë¦¬ê°°ìŠµë‹ˆë‹¤');
            
            // ëª¨ë“  ì˜¤íƒˆìê°€ ìˆ˜ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
            if (!hasError1 && !hasError2 && !hasError3 && !hasError4) {
                // ì—…ë¬´ ì™„ë£Œ ì²˜ë¦¬
                alert('ì—…ë¬´ì™„ë£Œ');
                
                const gameWindow = document.getElementById('gameWindow3');
                const windowContent = gameWindow.querySelector('.window-content');
                const taskComplete = document.getElementById('taskComplete3');
                
                windowContent.style.display = 'none';
                gameWindow.style.height = 'auto';
                gameWindow.classList.add('collapsed');
                taskComplete.style.display = 'block';
                
                // í—¤ë” í´ë¦­ ì‹œ ë‹¤ì‹œ í¼ì¹˜ê¸°
                const windowHeader = document.getElementById('windowHeader3');
                windowHeader.onclick = function(e) {
                    if (!windowHeader.classList.contains('dragging')) {
                        toggleWindowCollapse3();
                    }
                };
            } else {
                alert('ëª¨ë“  ì˜¤íƒˆìë¥¼ ìˆ˜ì •í•´ì£¼ì„¸ìš”.');
            }
        }
        
        function initCalendar() {
            const calendarDays = document.getElementById('calendarDays');
            const calendarTitle = document.getElementById('calendarTitle');
            const prevBtn = document.getElementById('prevMonth');
            const nextBtn = document.getElementById('nextMonth');
            
            if (!calendarDays || !calendarTitle) return;
            
            let currentYear = 2025;
            let currentMonth = 0; // 1ì›” (0-based index)
            
            function renderCalendar(year, month) {
                calendarDays.innerHTML = '';
                
                // í•´ë‹¹ ì›”ì˜ ì²« ë‚ ê³¼ ë§ˆì§€ë§‰ ë‚ 
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay()); // ì£¼ì˜ ì²« ë‚ ë¡œ
                
                // 6ì£¼ í‘œì‹œ (42ì¼)
                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    
                    // ë‚ ì§œ ì •ë³´ë¥¼ ì €ì¥ (í´ë¡œì € ë¬¸ì œ ë°©ì§€)
                    const dateYear = date.getFullYear();
                    const dateMonth = date.getMonth();
                    const dateDay = date.getDate();
                    
                    const dayElement = document.createElement('div');
                    dayElement.className = 'calendar-day';
                    dayElement.textContent = dateDay;
                    
                    // ë‹¤ë¥¸ ì›”ì˜ ë‚ ì§œ
                    if (dateMonth !== month) {
                        dayElement.classList.add('other-month');
                    }
                    
                    // ëª¨ë“  ë‚ ì§œì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                    dayElement.addEventListener('click', function() {
                        // 12ì›” 8ì¼ì¸ ê²½ìš°
                        if (dateYear === 2025 && dateMonth === 11 && dateDay === 8) {
                            completeTask2();
                        } else {
                            // ë‹¤ë¥¸ ë‚ ì§œì¸ ê²½ìš°
                            alert('íšŒì˜ ë‚ ì§œê°€ í‹€ë ¸ìŠµë‹ˆë‹¤');
                        }
                    });
                    
                    // 12ì›” 8ì¼ì¸ ê²½ìš° ìŠ¤íƒ€ì¼ ì¶”ê°€
                    if (dateYear === 2025 && dateMonth === 11 && dateDay === 8) {
                        dayElement.classList.add('target-date');
                    }
                    
                    calendarDays.appendChild(dayElement);
                }
                
                calendarTitle.textContent = `${year}ë…„ ${month + 1}ì›”`;
            }
            
            // ì´ì „/ë‹¤ìŒ ì›” ë²„íŠ¼
            if (prevBtn) {
                prevBtn.addEventListener('click', function() {
                    currentMonth--;
                    if (currentMonth < 0) {
                        currentMonth = 11;
                        currentYear--;
                    }
                    renderCalendar(currentYear, currentMonth);
                });
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('click', function() {
                    currentMonth++;
                    if (currentMonth > 11) {
                        currentMonth = 0;
                        currentYear++;
                    }
                    renderCalendar(currentYear, currentMonth);
                });
            }
            
            // ì´ˆê¸° ë Œë”ë§
            renderCalendar(currentYear, currentMonth);
        }
        
        function completeTask2() {
            alert('ì—…ë¬´ì™„ë£Œ');
            
            // ìœˆë„ìš°ë¥¼ í—¤ë”ë§Œ ë‚¨ê¸°ê³  ì ‘ê¸°
            const gameWindow = document.getElementById('gameWindow2');
            const windowContent = gameWindow.querySelector('.window-content');
            const taskComplete = document.getElementById('taskComplete2');
            
            windowContent.style.display = 'none';
            gameWindow.style.height = 'auto';
            gameWindow.classList.add('collapsed');
            taskComplete.style.display = 'block';
            
            // í—¤ë” í´ë¦­ ì‹œ ë‹¤ì‹œ í¼ì¹˜ê¸°
            const windowHeader = document.getElementById('windowHeader2');
            windowHeader.onclick = function(e) {
                // ë“œë˜ê·¸ ì¤‘ì´ ì•„ë‹ ë•Œë§Œ í¼ì¹˜ê¸°
                if (!windowHeader.classList.contains('dragging')) {
                    toggleWindowCollapse2();
                }
            };
        }
        
        function toggleWindowCollapse2() {
            const gameWindow = document.getElementById('gameWindow2');
            const windowContent = gameWindow.querySelector('.window-content');
            
            if (gameWindow.classList.contains('collapsed')) {
                // í¼ì¹˜ê¸°
                windowContent.style.display = 'flex';
                gameWindow.style.height = '400px';
                gameWindow.classList.remove('collapsed');
            } else {
                // ì ‘ê¸°
                windowContent.style.display = 'none';
                gameWindow.style.height = 'auto';
                gameWindow.classList.add('collapsed');
            }
        }
        
        function toggleInfoPanel2() {
            const panel = document.getElementById('infoPanel2');
            const content = document.getElementById('infoContent2');
            
            if (!panel) return;
            
            if (panel.classList.contains('minimized')) {
                panel.classList.remove('minimized');
                content.style.display = 'block';
                // right ì†ì„± ë³µì›
                if (panel.dataset.originalRight) {
                    panel.style.right = panel.dataset.originalRight;
                    panel.style.left = 'auto';
                } else {
                    // ì €ì¥ëœ ê°’ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
                    panel.style.right = '20px';
                    panel.style.left = 'auto';
                }
            } else {
                // ì¶•ì†Œ - ì˜¤ë¥¸ìª½ ìœ„ì¹˜ ìœ ì§€
                const computedStyle = window.getComputedStyle(panel);
                
                // originalRightê°€ ì—†ìœ¼ë©´ í˜„ì¬ ìƒíƒœì—ì„œ ì €ì¥
                if (!panel.dataset.originalRight) {
                    if (computedStyle.right !== 'auto') {
                        panel.dataset.originalRight = computedStyle.right;
                    } else if (computedStyle.left !== 'auto') {
                        // leftë¥¼ rightë¡œ ë³€í™˜
                        const leftValue = parseInt(computedStyle.left) || 0;
                        const rightValue = window.innerWidth - leftValue - panel.offsetWidth;
                        panel.dataset.originalRight = rightValue + 'px';
                    } else {
                        panel.dataset.originalRight = '20px';
                    }
                }
                
                // right ì†ì„± ì„¤ì •
                panel.style.right = panel.dataset.originalRight;
                panel.style.left = 'auto';
                panel.classList.add('minimized');
                content.style.display = 'none';
            }
        }
        
        function initGame2Drag() {
            const gameWindow = document.getElementById('gameWindow2');
            const windowHeader = document.getElementById('windowHeader2');
            
            if (!gameWindow || !windowHeader) return;
            
            let isDragging = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;

            const rect = gameWindow.getBoundingClientRect();
            xOffset = rect.left;
            yOffset = rect.top;

            windowHeader.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            windowHeader.addEventListener('touchstart', dragStartTouch);
            document.addEventListener('touchmove', dragTouch);
            document.addEventListener('touchend', dragEnd);

            function dragStart(e) {
                if (e.type === "touchstart") {
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }
                isDragging = true;
                gameWindow.classList.add('dragging');
            }

            function dragStartTouch(e) {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
                isDragging = true;
                gameWindow.classList.add('dragging');
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    if (e.type === "touchmove") {
                        currentX = e.touches[0].clientX - initialX;
                        currentY = e.touches[0].clientY - initialY;
                    } else {
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                    }
                    xOffset = currentX;
                    yOffset = currentY;
                    const maxX = window.innerWidth - gameWindow.offsetWidth;
                    const maxY = window.innerHeight - gameWindow.offsetHeight;
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));
                    setTranslate(xOffset, yOffset, gameWindow);
                }
            }

            function dragTouch(e) {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                    xOffset = currentX;
                    yOffset = currentY;
                    const maxX = window.innerWidth - gameWindow.offsetWidth;
                    const maxY = window.innerHeight - gameWindow.offsetHeight;
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));
                    setTranslate(xOffset, yOffset, gameWindow);
                }
            }

            function dragEnd(e) {
                initialX = currentX;
                initialY = currentY;
                isDragging = false;
                gameWindow.classList.remove('dragging');
            }

            function setTranslate(xPos, yPos, el) {
                el.style.left = xPos + 'px';
                el.style.top = yPos + 'px';
                el.style.transform = 'none';
            }
        }
        
        function closeInfoPanel() {
            document.getElementById('infoPanel').style.display = 'none';
        }
        
        function toggleInfoPanel() {
            const panel = document.getElementById('infoPanel');
            const content = document.getElementById('infoContent');
            
            if (!panel) return;
            
            if (panel.classList.contains('minimized')) {
                // í™•ì¥
                panel.classList.remove('minimized');
                content.style.display = 'block';
                // right ì†ì„± ë³µì›
                if (panel.dataset.originalRight) {
                    panel.style.right = panel.dataset.originalRight;
                    panel.style.left = 'auto';
                } else {
                    // ì €ì¥ëœ ê°’ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
                    panel.style.right = '20px';
                    panel.style.left = 'auto';
                }
            } else {
                // ì¶•ì†Œ - ì˜¤ë¥¸ìª½ ìœ„ì¹˜ ìœ ì§€
                const computedStyle = window.getComputedStyle(panel);
                
                // originalRightê°€ ì—†ìœ¼ë©´ í˜„ì¬ ìƒíƒœì—ì„œ ì €ì¥
                if (!panel.dataset.originalRight) {
                    if (computedStyle.right !== 'auto') {
                        panel.dataset.originalRight = computedStyle.right;
                    } else if (computedStyle.left !== 'auto') {
                        // leftë¥¼ rightë¡œ ë³€í™˜
                        const leftValue = parseInt(computedStyle.left) || 0;
                        const rightValue = window.innerWidth - leftValue - panel.offsetWidth;
                        panel.dataset.originalRight = rightValue + 'px';
                    } else {
                        panel.dataset.originalRight = '20px';
                    }
                }
                
                // right ì†ì„± ì„¤ì •
                panel.style.right = panel.dataset.originalRight;
                panel.style.left = 'auto';
                panel.classList.add('minimized');
                content.style.display = 'none';
            }
        }
        
        function toggleWindowCollapse() {
            const gameWindow = document.getElementById('gameWindow1');
            const windowContent = gameWindow.querySelector('.window-content');
            
            if (gameWindow.classList.contains('collapsed')) {
                // í¼ì¹˜ê¸°
                windowContent.style.display = 'flex';
                gameWindow.style.height = '400px';
                gameWindow.classList.remove('collapsed');
            } else {
                // ì ‘ê¸°
                windowContent.style.display = 'none';
                gameWindow.style.height = 'auto';
                gameWindow.classList.add('collapsed');
            }
        }
        
        function sendEmail() {
            const to = document.getElementById('emailTo').value.trim();
            const subject = document.getElementById('emailSubject').value.trim();
            const body = document.getElementById('emailBody').value;
            
            if (!to || !subject || !body.trim()) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì •ë‹µ (ì›ë¬¸ ë‚´ìš©)
            const correctTo = 'example@email.com';
            const correctSubject = 'íšŒì˜ ì•ˆë‚´';
            const correctBody = 'ì•ˆë…•í•˜ì„¸ìš”, ë””ìì¸ ê²€í†  ë¯¸íŒ…ì´ 2025ë…„ 12ì›” 8ì¼ ì˜¤í›„ 2ì‹œì— ì˜ˆì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.';
            
            // ë³¸ë¬¸ ë¹„êµ í•¨ìˆ˜ (ì¤„ë°”ê¿ˆ ì œê±° ë° ê³µë°± ì •ê·œí™”)
            function normalizeText(text) {
                return text
                    .replace(/\r\n/g, ' ')  // Windows ì¤„ë°”ê¿ˆì„ ê³µë°±ìœ¼ë¡œ
                    .replace(/\r/g, ' ')    // Mac ì¤„ë°”ê¿ˆì„ ê³µë°±ìœ¼ë¡œ
                    .replace(/\n/g, ' ')    // Unix ì¤„ë°”ê¿ˆì„ ê³µë°±ìœ¼ë¡œ
                    .replace(/[ \t]+/g, ' ')  // ì—¬ëŸ¬ ê³µë°±ì„ í•˜ë‚˜ë¡œ
                    .trim();
            }
            
            // ì˜¤íƒ€ ê²€ì‚¬
            const isToCorrect = to === correctTo;
            const isSubjectCorrect = subject === correctSubject;
            const isBodyCorrect = normalizeText(body) === normalizeText(correctBody);
            
            if (isToCorrect && isSubjectCorrect && isBodyCorrect) {
                alert('ë©”ì¼ ë³´ë‚´ê¸° ì„±ê³µ');
                
                // ìœˆë„ìš°ë¥¼ í—¤ë”ë§Œ ë‚¨ê¸°ê³  ì ‘ê¸°
                const gameWindow = document.getElementById('gameWindow1');
                const windowContent = gameWindow.querySelector('.window-content');
                const taskComplete = document.getElementById('taskComplete');
                
                windowContent.style.display = 'none';
                gameWindow.style.height = 'auto';
                gameWindow.classList.add('collapsed');
                taskComplete.style.display = 'block';
                
                // í—¤ë” í´ë¦­ ì‹œ ë‹¤ì‹œ í¼ì¹˜ê¸°
                const windowHeader = document.getElementById('windowHeader1');
                windowHeader.onclick = function(e) {
                    // ë“œë˜ê·¸ ì¤‘ì´ ì•„ë‹ ë•Œë§Œ í¼ì¹˜ê¸°
                    if (!windowHeader.classList.contains('dragging')) {
                        toggleWindowCollapse();
                    }
                };
            } else {
                alert('ì˜¤íƒ€ê°€ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì „ì†¡í•˜ì„¸ìš”.');
            }
        }
        
        function openOriginalModal(e) {
            e.preventDefault();
            // ì›ë¬¸ ë‚´ìš©ì„ ì—¬ê¸°ì— ì‘ì„±í•˜ì„¸ìš”
            const originalText = `ë°›ëŠ” ì‚¬ëŒ 
example@email.com
ì œëª©
íšŒì˜ ì•ˆë‚´
ë‚´ìš©
ì•ˆë…•í•˜ì„¸ìš”, ë””ìì¸ ê²€í†  ë¯¸íŒ…ì´ 2025ë…„ 12ì›” 8ì¼ ì˜¤í›„ 2ì‹œì— ì˜ˆì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
ê°ì‚¬í•©ë‹ˆë‹¤.`;
            
            const modal = document.getElementById('originalModal');
            const modalContent = document.getElementById('originalModalContent');
            const modalBody = document.getElementById('originalModalBody');
            const modalHeader = document.getElementById('originalModalHeader');
            
            // "ë°›ëŠ” ì‚¬ëŒ", "ì œëª©", "ë‚´ìš©"ì— ë°‘ì¤„ ì ìš©
            const formattedText = originalText
                .replace(/ë°›ëŠ” ì‚¬ëŒ/g, '<span class="original-label">ë°›ëŠ” ì‚¬ëŒ</span>')
                .replace(/ì œëª©/g, '<span class="original-label">ì œëª©</span>')
                .replace(/ë‚´ìš©/g, '<span class="original-label">ë‚´ìš©</span>');
            
            modalBody.innerHTML = '<p style="white-space: pre-wrap; margin: 0;">' + formattedText + '</p>';
            modal.style.display = 'block';
            
            // ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
            initOriginalModalDrag(modalContent, modalHeader);
        }
        
        function closeOriginalModal() {
            document.getElementById('originalModal').style.display = 'none';
        }
        
        function initOriginalModalDrag(modalContent, modalHeader) {
            let isDragging = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;

            // ëª¨ë‹¬ì˜ ì´ˆê¸° ìœ„ì¹˜ ì„¤ì • (í™”ë©´ ì¤‘ì•™)
            const rect = modalContent.getBoundingClientRect();
            if (xOffset === 0 && yOffset === 0) {
                xOffset = (window.innerWidth - rect.width) / 2;
                yOffset = (window.innerHeight - rect.height) / 2;
                setTranslate(xOffset, yOffset, modalContent);
            }

            modalHeader.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            // í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì› (ëª¨ë°”ì¼)
            modalHeader.addEventListener('touchstart', dragStartTouch);
            document.addEventListener('touchmove', dragTouch);
            document.addEventListener('touchend', dragEnd);

            function dragStart(e) {
                if (e.type === "touchstart") {
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }

                isDragging = true;
                modalContent.classList.add('dragging');
            }

            function dragStartTouch(e) {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
                isDragging = true;
                modalContent.classList.add('dragging');
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    
                    if (e.type === "touchmove") {
                        currentX = e.touches[0].clientX - initialX;
                        currentY = e.touches[0].clientY - initialY;
                    } else {
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                    }

                    xOffset = currentX;
                    yOffset = currentY;

                    // í™”ë©´ ê²½ê³„ ë‚´ì—ì„œë§Œ ì´ë™í•˜ë„ë¡ ì œí•œ
                    const maxX = window.innerWidth - modalContent.offsetWidth;
                    const maxY = window.innerHeight - modalContent.offsetHeight;
                    
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));

                    setTranslate(xOffset, yOffset, modalContent);
                }
            }

            function dragTouch(e) {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;

                    xOffset = currentX;
                    yOffset = currentY;

                    const maxX = window.innerWidth - modalContent.offsetWidth;
                    const maxY = window.innerHeight - modalContent.offsetHeight;
                    
                    xOffset = Math.max(0, Math.min(xOffset, maxX));
                    yOffset = Math.max(0, Math.min(yOffset, maxY));

                    setTranslate(xOffset, yOffset, modalContent);
                }
            }

            function dragEnd(e) {
                initialX = currentX;
                initialY = currentY;
                isDragging = false;
                modalContent.classList.remove('dragging');
            }

            function setTranslate(xPos, yPos, el) {
                el.style.left = xPos + 'px';
                el.style.top = yPos + 'px';
                el.style.transform = 'none';
            }
        }
    </script>
    <script>
        // intro.htmlì—ì„œ ì˜¨ ê²½ìš° í…ìŠ¤íŠ¸ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œ
        window.addEventListener('DOMContentLoaded', function() {
            const introShown = sessionStorage.getItem('introShown');
            const showIntroText = sessionStorage.getItem('showIntroText');
            
            if (introShown === 'true' && showIntroText === 'true') {
                // í…ìŠ¤íŠ¸ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œ
                showIntroTexts();
                sessionStorage.removeItem('showIntroText');
            } else if (introShown === 'true') {
                const mainContainer = document.getElementById('mainContainer');
                const gamesWrapper = document.getElementById('gamesWrapper');
                if (mainContainer && gamesWrapper) {
                    mainContainer.style.display = 'none';
                    gamesWrapper.style.display = 'block';
                    enterGames();
                }
            }
        });
        
        function showIntroTexts() {
            const introTextContainer = document.getElementById('introTextContainer');
            const introText = document.getElementById('introText');
            const startBtn = document.getElementById('startBtn');
            
            if (!introTextContainer || !introText) return;
            
            introTextContainer.style.display = 'block';
            
            const texts = [
                'ì˜¤ëŠ˜ë„ íšŒì‚¬ì—ì„œ í•  ì¼ë“¤ì´ ìŒ“ì˜€ë‚˜ìš”?',
                'ê·¸ë˜ì„œ ìš°ë¦¬ëŠ” ì¢…ì¢… ì—¬ëŸ¬ ì¼ì„ ë™ì‹œì— ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤',
                'í•˜ì§€ë§Œ ê·¸ê±´ íš¨ìœ¨ì ì´ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                'ì§ì ‘ ì²´í—˜í•´ë³´ì„¸ìš”'
            ];
            
            let currentIndex = 0;
            
            function showNextText() {
                if (currentIndex >= texts.length) {
                    // ëª¨ë“  í…ìŠ¤íŠ¸ê°€ ëë‚œ í›„ ë²„íŠ¼ í‘œì‹œ
                    setTimeout(() => {
                        if (startBtn) {
                            startBtn.style.opacity = '1';
                        }
                    }, 500);
                    return;
                }
                
                // ì´ì „ í…ìŠ¤íŠ¸ ì‚¬ë¼ì§€ê¸°
                introText.style.opacity = '0';
                
                setTimeout(() => {
                    // ìƒˆ í…ìŠ¤íŠ¸ ì„¤ì •
                    introText.textContent = texts[currentIndex];
                    // ìƒˆ í…ìŠ¤íŠ¸ ë‚˜íƒ€ë‚˜ê¸°
                    setTimeout(() => {
                        introText.style.opacity = '1';
                    }, 100);
                    
                    currentIndex++;
                    
                    // ë‹¤ìŒ í…ìŠ¤íŠ¸ë¡œ (ê° í…ìŠ¤íŠ¸ëŠ” 2ì´ˆê°„ í‘œì‹œ)
                    setTimeout(() => {
                        showNextText();
                    }, 2000);
                }, 300);
            }
            
            // ì²« ë²ˆì§¸ í…ìŠ¤íŠ¸ ì‹œì‘ (íŒŒë™ì´ ëë‚˜ë©´ ë°”ë¡œ í‘œì‹œ)
            setTimeout(() => {
                showNextText();
            }, 100);
        }
    </script>
</body>
</html>